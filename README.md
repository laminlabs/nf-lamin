# nf-lamin plugin

A Nextflow plugin that integrates
[LaminDB](https://github.com/laminlabs/lamindb) data provenance into
Nextflow workflows.

## Installation

To install a development build of the plugin, run the following command:

```bash
make install
```

To uninstall the plugin, run the following command:

```bash
make uninstall
```

## Usage

To use the plugin in a Nextflow workflow, create a Nextflow config
`nextflow.config` that specifies which LaminDB instance to use and an
API key:

```groovy
plugins {
  id 'nf-lamin'
}

lamin {
  instance = "laminlabs/lamindata"
  api_key = secrets.LAMIN_API_KEY
}
```

> [!TIP]
>
> If you haven’t done so already, you’ll need to define the
> `LAMIN_API_KEY` secret in your Nextflow configuration:
>
> - Fetch a Lamin API key from your [Lamin Hub account
>   settings](https://lamin.ai/settings).
> - Run the command `nextflow secrets set LAMIN_API_KEY "..."` to set
>   the secret in your Nextflow configuration.

### Example with nf-core/scrnaseq workflow:

```bash
nextflow run nf-core/scrnaseq \
  -latest \
  -r 2.7.1 \
  -profile docker \
  -plugins nf-lamin@0.1.0 \
  --input https://github.com/nf-core/test-datasets/raw/scrnaseq/samplesheet-2-0.csv \
  --fasta https://github.com/nf-core/test-datasets/raw/scrnaseq/reference/GRCm38.p6.genome.chr19.fa \
  --gtf https://github.com/nf-core/test-datasets/raw/scrnaseq/reference/gencode.vM19.annotation.chr19.gtf \
  --protocol 10XV2 \
  --skip_emptydrops \
  --outdir gs://di-temporary-public/scratch/temp-scrnaseq/run_$(date +%Y%m%d_%H%M%S)
```

    Nextflow 25.04.4 is available - Please consider updating your version to it
    N E X T F L O W  ~  version 24.10.5
    Pulling nf-core/scrnaseq ...
    Launching `https://github.com/nf-core/scrnaseq` [exotic_swartz] DSL2 - revision: 4171377f40 [2.7.1]
    ✅ Connected to LaminDB instance 'laminlabs/lamindata' as 'rcannood'
    Transform J49HdErpEFrs0000 (https://staging.laminhub.com/laminlabs/lamindata/transform/J49HdErpEFrs0000)
    Run ggdtzXYlvVqGjVpHfwcL (https://staging.laminhub.com/laminlabs/lamindata/transform/J49HdErpEFrs0000/ggdtzXYlvVqGjVpHfwcL)


    ------------------------------------------------------
                                            ,--./,-.
            ___     __   __   __   ___     /,-._.--~'
      |\ | |__  __ /  ` /  \ |__) |__         }  {
      | \| |       \__, \__/ |  \ |___     \`-._,-`-,
                                            `._,._,'
      nf-core/scrnaseq v2.7.1-g4171377
    ------------------------------------------------------
    Core Nextflow options
      revision       : 2.7.1
      runName        : exotic_swartz
      containerEngine: docker
      launchDir      : /home/rcannood/workspace/laminlabs/nf-lamin
      workDir        : /home/rcannood/workspace/laminlabs/nf-lamin/work
      projectDir     : /home/rcannood/.nextflow/assets/nf-core/scrnaseq
      userName       : rcannood
      profile        : docker
      configFiles    :

    Input/output options
      input          : https://github.com/nf-core/test-datasets/raw/scrnaseq/samplesheet-2-0.csv
      outdir         : gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908

    Mandatory arguments
      protocol       : 10XV2

    Skip Tools
      skip_emptydrops: true

    Reference genome options
      fasta          : https://github.com/nf-core/test-datasets/raw/scrnaseq/reference/GRCm38.p6.genome.chr19.fa
      gtf            : https://github.com/nf-core/test-datasets/raw/scrnaseq/reference/gencode.vM19.annotation.chr19.gtf

    !! Only displaying parameters that differ from the pipeline defaults !!
    ------------------------------------------------------
    If you use nf-core/scrnaseq for your analysis please cite:

    * The pipeline
      https://doi.org/10.5281/zenodo.3568187

    * The nf-core framework
      https://doi.org/10.1038/s41587-020-0439-x

    * Software dependencies
      https://github.com/nf-core/scrnaseq/blob/master/CITATIONS.md
    ------------------------------------------------------
    Staging foreign file: https://github.com/nf-core/test-datasets/raw/scrnaseq/reference/GRCm38.p6.genome.chr19.fa
    [9b/262266] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:FASTQC_CHECK:FASTQC (Sample_Y)
    [5b/19c615] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:FASTQC_CHECK:FASTQC (Sample_X)
    Staging foreign file: https://github.com/nf-core/test-datasets/raw/scrnaseq/reference/gencode.vM19.annotation.chr19.gtf
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_1_fastqc.zip.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.html.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.zip.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.html.
    [43/4dbedf] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:GTF_GENE_FILTER (GRCm38.p6.genome.chr19.fa)
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_4_fastqc.html.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.zip.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_2_fastqc.html.
    [1b/3c02f1] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:SCRNASEQ_ALEVIN:SIMPLEAF_INDEX (GRCm38.p6.genome.chr19_genes.gtf)
    [c7/b060a2] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:SCRNASEQ_ALEVIN:SIMPLEAF_QUANT (Sample_X)
    [59/65ede7] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:SCRNASEQ_ALEVIN:SIMPLEAF_QUANT (Sample_Y)
    [15/c3fb09] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:SCRNASEQ_ALEVIN:ALEVINQC (Sample_X)
    [fa/ada24b] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:MTX_CONVERSION:MTX_TO_SEURAT (Sample_X)
    [37/9a497e] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:MTX_CONVERSION:MTX_TO_H5AD (Sample_X)
    [59/16539e] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:SCRNASEQ_ALEVIN:ALEVINQC (Sample_Y)
    [06/472413] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:MTX_CONVERSION:MTX_TO_SEURAT (Sample_Y)
    [85/71dcfa] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:MTX_CONVERSION:MTX_TO_H5AD (Sample_Y)
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_X/Sample_X_raw_matrix.rds.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml.
    [30/62ab4b] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:MTX_CONVERSION:CONCAT_H5AD (1)
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_Y/Sample_Y_raw_matrix.h5ad.
    ERROR ~ Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml.
    [83/deb810] Submitted process > NFCORE_SCRNASEQ:SCRNASEQ:MULTIQC
    Waiting for file transfers to complete (2 files)
    -[nf-core/scrnaseq] Pipeline completed successfully-

<details>

<summary>

Detailed logs produced by `nf-lamin` in `.nextflow.log`

</summary>

    DEBUG nextflow.lamin.LaminObserver - onFlowCreate triggered!
    DEBUG nextflow.lamin.hub.LaminHub - Fetching access token...
    DEBUG nextflow.lamin.hub.LaminHub - Access token refreshed successfully.
    DEBUG nextflow.lamin.instance.Instance - GET /account
    DEBUG nextflow.lamin.instance.Instance - Response from getAccount: [id:b18149dc-7062-4f5e-8f2b-a82c7e13c5ed, lnid:QVOJJSTi, handle:rcannood, user_id:b18149dc-7062-4f5e-8f2b-a82c7e13c5ed, name:null, bio:null, website:null, github_handle:null, twitter_handle:null, linkedin_handle:null, avatar_url:b18149dc-7062-4f5e-8f2b-a82c7e13c5ed/avatar.png, created_at:2025-05-19T07:20:22.157833Z, updated_at:null]
    INFO  nextflow.lamin.LaminObserver - ✅ Connected to LaminDB instance 'laminlabs/lamindata' as 'rcannood'
    DEBUG nextflow.lamin.LaminObserver - Searching for existing Transform with key https://github.com/nf-core/scrnaseq and revision 2.7.1
    DEBUG nextflow.lamin.instance.Instance - POST getRecords: core.transform, filter=[and:[[key:[eq:https://github.com/nf-core/scrnaseq]], [version:[eq:2.7.1]]]], limit=50, offset=0
    DEBUG nextflow.lamin.instance.Instance - Response from getRecords: [[type:pipeline, key:https://github.com/nf-core/scrnaseq, source_code:{"repository":"https://github.com/nf-core/scrnaseq","main-script":"main.nf","commit-id":"4171377f40d629d43d4ca71654a7ea06e5619a09","revision":"2.7.1"}, version:2.7.1, reference:https://github.com/nf-core/scrnaseq, created_at:2025-06-17T13:23:13.367928+00:00, description:nf-core/scrnaseq: Pipeline for processing 10x Genomics single cell rnaseq data, hash:IjU-vwpcB5AhQiNx1fjD1w, uid:J49HdErpEFrs0000, id:331.0, updated_at:2025-06-17T13:23:13.367928+00:00, reference_type:url, is_latest:true, _aux:null]]
    DEBUG nextflow.lamin.LaminObserver - Found 1 existing Transform(s) with key https://github.com/nf-core/scrnaseq and revision 2.7.1
    INFO  nextflow.lamin.LaminObserver - Transform J49HdErpEFrs0000 (https://staging.laminhub.com/laminlabs/lamindata/transform/J49HdErpEFrs0000)
    DEBUG nextflow.lamin.instance.Instance - PUT createRecord: core.run, data=[transform_id:331.0, name:exotic_swartz, created_at:2025-06-17T16:29:11.834455856+02:00, started_at:2025-06-17T16:29:11.834455856+02:00, _status_code:-1]
    DEBUG nextflow.lamin.instance.Instance - Response from createRecord: [[id:602.0, uid:ggdtzXYlvVqGjVpHfwcL, _aux:null, name:exotic_swartz, space_id:1.0, _branch_code:1.0, report_id:null, _logfile_id:null, reference:null, transform_id:331.0, created_at:2025-06-17T14:29:15.019270+00:00, created_by_id:28.0, started_at:2025-06-17T14:29:11.834456+00:00, environment_id:null, finished_at:null, _status_code:-1.0, reference_type:null, _is_consecutive:null, initiated_by_run_id:null]]
    INFO  nextflow.lamin.LaminObserver - Run ggdtzXYlvVqGjVpHfwcL (https://staging.laminhub.com/laminlabs/lamindata/transform/J49HdErpEFrs0000/ggdtzXYlvVqGjVpHfwcL)
    Jun-17 16:29:26.671 [TaskFinalizer-1] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:27.222 [PublishDir-3] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:27.222 [PublishDir-3] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_1_fastqc.zip
    Jun-17 16:29:27.223 [PublishDir-3] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_1_fastqc.zip","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:27.295 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:27.296 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_1_fastqc.html
    Jun-17 16:29:27.296 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_1_fastqc.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:27.346 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:27.346 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.html
    Jun-17 16:29:27.346 [PublishDir-2] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:27.472 [TaskFinalizer-2] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:27.495 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:27.496 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.zip
    Jun-17 16:29:27.496 [PublishDir-4] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.zip","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:28.001 [PublishDir-8] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:28.001 [PublishDir-8] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_4_fastqc.html
    Jun-17 16:29:28.001 [PublishDir-8] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_4_fastqc.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:28.261 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:28.261 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.html
    Jun-17 16:29:28.262 [PublishDir-5] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:28.365 [PublishDir-9] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:28.365 [PublishDir-9] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.zip
    Jun-17 16:29:28.366 [PublishDir-9] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.zip","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:28.376 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:28.376 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_2_fastqc.zip
    Jun-17 16:29:28.376 [PublishDir-10] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_2_fastqc.zip","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:28.433 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:28.433 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_2_fastqc.html
    Jun-17 16:29:28.433 [PublishDir-6] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_2_fastqc.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:28.478 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:28.478 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_3_fastqc.html
    Jun-17 16:29:28.478 [PublishDir-7] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_3_fastqc.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:29.990 [PublishDir-3] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_1_fastqc.zip: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- InvalidCursorName: cursor \"_django_curs_139659823852416_sync_2\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_139659823852416_sync_2\" does not exist\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in cursor_iter\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in <lambda>\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 97, in inner\\n    with self:\\n         ^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.OperationalError: cursor \"_django_curs_139659823852416_sync_2\" does not exist\\n\\n\\nDuring handling of the above exception, another exception occurred:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2115, in cursor_iter\\n    cursor.close()\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_139659823852416_sync_2\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:29 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:30.083 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T13:27:25.181Z, updated_at:2025-06-17T13:27:25.181Z, uid:eqsOa0HLmO6kwDbr0000, key:scratch/temp-scrnaseq/run_20250617_152628/fastqc/Sample_X_1_fastqc.html, description:Output artifact for run 602, storage:32.0, suffix:.html, kind:null, otype:null, size:491518.0, hash:c8MNO5LRswzNpSeVJab96Q, n_files:null, n_observations:null, _hash_type:md5, run:589.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:30.083 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Detected previous output artifact eqsOa0HLmO6kwDbr0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/eqsOa0HLmO6kwDbr0000)
    Jun-17 16:29:30.432 [PublishDir-3] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:30.433 [PublishDir-3] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_3_fastqc.zip
    Jun-17 16:29:30.433 [PublishDir-3] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_3_fastqc.zip","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:30.503 [PublishDir-5] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.html: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- OperationalError: cursor \"_django_curs_139996198652800_sync_1\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_139996198652800_sync_1\" does not exist\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in cursor_iter\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in <lambda>\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 97, in inner\\n    with self:\\n         ^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.OperationalError: cursor \"_django_curs_139996198652800_sync_1\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:30 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:30.518 [PublishDir-4] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.zip: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- OperationalError: cursor \"_django_curs_140312843398016_sync_1\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_140312843398016_sync_1\" does not exist\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in cursor_iter\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in <lambda>\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 97, in inner\\n    with self:\\n         ^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.OperationalError: cursor \"_django_curs_140312843398016_sync_1\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:30 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:30.525 [PublishDir-2] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_X_2_fastqc.html: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- InvalidCursorName: cursor \"_django_curs_139682122701696_sync_1\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_139682122701696_sync_1\" does not exist\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in cursor_iter\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in <lambda>\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 97, in inner\\n    with self:\\n         ^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.OperationalError: cursor \"_django_curs_139682122701696_sync_1\" does not exist\\n\\n\\nDuring handling of the above exception, another exception occurred:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2115, in cursor_iter\\n    cursor.close()\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_139682122701696_sync_1\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:30 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:30.541 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:30.541 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_4_fastqc.zip
    Jun-17 16:29:30.542 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_4_fastqc.zip","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:30.745 [PublishDir-8] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_4_fastqc.html: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- ProgrammingError: cursor \"_django_curs_139727121922944_sync_3\" already exists\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.DuplicateCursor: cursor \"_django_curs_139727121922944_sync_3\" already exists\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 91, in __iter__\\n    results = compiler.execute_sql(\\n              ^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 1574, in execute_sql\\n    cursor.execute(sql, params)\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 79, in execute\\n    return self._execute_with_wrappers(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 92, in _execute_with_wrappers\\n    return executor(sql, params, many, context)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 100, in _execute\\n    with self.db.wrap_database_errors:\\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.ProgrammingError: cursor \"_django_curs_139727121922944_sync_3\" already exists\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:30 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:30.789 [PublishDir-9] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_1_fastqc.zip: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- OperationalError: cursor \"_django_curs_140517052316544_sync_1\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_140517052316544_sync_1\" does not exist\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in cursor_iter\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in <lambda>\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 97, in inner\\n    with self:\\n         ^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.OperationalError: cursor \"_django_curs_140517052316544_sync_1\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:30 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:30.795 [PublishDir-6] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_2_fastqc.html: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- OperationalError: cursor \"_django_curs_140191518493568_sync_2\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_140191518493568_sync_2\" does not exist\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in cursor_iter\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2112, in <lambda>\\n    for rows in iter((lambda: cursor.fetchmany(itersize)), sentinel):\\n                              ^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 97, in inner\\n    with self:\\n         ^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 98, in inner\\n    return func(*args, **kwargs)\\n           ^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.OperationalError: cursor \"_django_curs_140191518493568_sync_2\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:30 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:31.021 [PublishDir-10] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:29:30.903Z, updated_at:2025-06-17T14:29:30.903Z, uid:4MRZQ56adxTRbYoH0000, key:scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_2_fastqc.zip, description:Output artifact for run 602, storage:32.0, suffix:.zip, kind:null, otype:null, size:359696.0, hash:sAa8BIJumNyGDDiMobOiOA, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:31.021 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - Created output artifact 4MRZQ56adxTRbYoH0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/4MRZQ56adxTRbYoH0000)
    Jun-17 16:29:31.136 [PublishDir-7] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T13:27:49.120Z, updated_at:2025-06-17T13:27:49.120Z, uid:d4KMUYazMbo8E3Sb0000, key:scratch/temp-scrnaseq/run_20250617_152628/fastqc/Sample_Y_3_fastqc.html, description:Output artifact for run 602, storage:32.0, suffix:.html, kind:null, otype:null, size:493192.0, hash:fVq4y8OMrPaIAbgME8Ya/Q, n_files:null, n_observations:null, _hash_type:md5, run:589.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:31.136 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - Detected previous output artifact d4KMUYazMbo8E3Sb0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/d4KMUYazMbo8E3Sb0000)
    Jun-17 16:29:31.518 [TaskFinalizer-3] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:32.667 [PublishDir-3] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:29:32.530Z, updated_at:2025-06-17T14:29:32.530Z, uid:IuiNo48Ny3AFt5RV0000, key:scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_3_fastqc.zip, description:Output artifact for run 602, storage:32.0, suffix:.zip, kind:null, otype:null, size:319942.0, hash:Lki5O4xoYZebRC+D88jMWQ, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:32.667 [PublishDir-3] DEBUG nextflow.lamin.LaminObserver - Created output artifact IuiNo48Ny3AFt5RV0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/IuiNo48Ny3AFt5RV0000)
    Jun-17 16:29:33.023 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:29:32.910Z, updated_at:2025-06-17T14:29:32.910Z, uid:pJMwISbQhhNDYYtd0000, key:scratch/temp-scrnaseq/run_20250617_162908/fastqc/Sample_Y_4_fastqc.zip, description:Output artifact for run 602, storage:32.0, suffix:.zip, kind:null, otype:null, size:383802.0, hash:KKLBRFJB8SzhVMA5gWF1xQ, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:33.024 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Created output artifact pJMwISbQhhNDYYtd0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/pJMwISbQhhNDYYtd0000)
    Jun-17 16:29:46.471 [TaskFinalizer-4] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:50.118 [TaskFinalizer-5] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:50.350 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:50.351 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/versions.yml
    Jun-17 16:29:50.351 [PublishDir-4] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/versions.yml","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:53.117 [PublishDir-4] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T13:28:41.851Z, updated_at:2025-06-17T13:28:41.851Z, uid:56BoSg5Ct2LI5qWP0000, key:scratch/temp-scrnaseq/run_20250617_152628/alevin/versions.yml, description:Output artifact for run 602, storage:32.0, suffix:.yml, kind:null, otype:null, size:99.0, hash:LD8rptl+frwRArJCKdnQCA, n_files:null, n_observations:null, _hash_type:md5, run:589.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:53.117 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - Detected previous output artifact 56BoSg5Ct2LI5qWP0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/56BoSg5Ct2LI5qWP0000)
    Jun-17 16:29:53.510 [TaskFinalizer-6] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:53.737 [PublishDir-8] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:53.737 [PublishDir-8] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml
    Jun-17 16:29:53.737 [PublishDir-8] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:53.759 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:53.759 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_X/Sample_X_raw_matrix.rds
    Jun-17 16:29:53.759 [PublishDir-2] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_X/Sample_X_raw_matrix.rds","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:54.358 [TaskFinalizer-7] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:54.709 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:54.709 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/versions.yml
    Jun-17 16:29:54.709 [PublishDir-6] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/versions.yml","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:55.329 [TaskFinalizer-8] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:55.426 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:55.427 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/Sample_X_alevin_results
    Jun-17 16:29:55.427 [PublishDir-5] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/Sample_X_alevin_results","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:55.614 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:55.614 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_X/Sample_X_raw_matrix.h5ad
    Jun-17 16:29:55.615 [PublishDir-10] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_X/Sample_X_raw_matrix.h5ad","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:55.699 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:55.699 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml
    Jun-17 16:29:55.700 [PublishDir-7] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:56.355 [PublishDir-2] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_X/Sample_X_raw_matrix.rds: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- InvalidCursorName: cursor \"_django_curs_139727121922944_sync_1\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2115, in cursor_iter\\n    cursor.close()\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_139727121922944_sync_1\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:56 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:56.356 [PublishDir-8] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- InvalidCursorName: cursor \"_django_curs_140191518493568_sync_1\" does not exist\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 123, in __iter__\\n    for row in compiler.results_iter(results):\\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 2115, in cursor_iter\\n    cursor.close()\\npsycopg2.errors.InvalidCursorName: cursor \"_django_curs_140191518493568_sync_1\" does not exist\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:56 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:56.809 [PublishDir-6] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T13:28:41.851Z, updated_at:2025-06-17T13:28:41.851Z, uid:56BoSg5Ct2LI5qWP0000, key:scratch/temp-scrnaseq/run_20250617_152628/alevin/versions.yml, description:Output artifact for run 602, storage:32.0, suffix:.yml, kind:null, otype:null, size:99.0, hash:LD8rptl+frwRArJCKdnQCA, n_files:null, n_observations:null, _hash_type:md5, run:589.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:56.810 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - Detected previous output artifact 56BoSg5Ct2LI5qWP0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/56BoSg5Ct2LI5qWP0000)
    Jun-17 16:29:57.143 [TaskFinalizer-9] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:57.494 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:57.494 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml
    Jun-17 16:29:57.494 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:57.558 [PublishDir-3] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:57.558 [PublishDir-3] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_Y/Sample_Y_raw_matrix.h5ad
    Jun-17 16:29:57.558 [PublishDir-3] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_Y/Sample_Y_raw_matrix.h5ad","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:57.676 [PublishDir-5] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:29:57.561Z, updated_at:2025-06-17T14:29:57.561Z, uid:srNIgDGGPSyAXiWp0000, key:scratch/temp-scrnaseq/run_20250617_162908/alevin/Sample_X_alevin_results, description:Output artifact for run 602, storage:32.0, suffix:, kind:null, otype:null, size:1.1914941E7, hash:j2wZ18AS23vNmzNLl0EA4A, n_files:19.0, n_observations:null, _hash_type:md5-d, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:true, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:57.677 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - Created output artifact srNIgDGGPSyAXiWp0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/srNIgDGGPSyAXiWp0000)
    Jun-17 16:29:57.753 [TaskFinalizer-10] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:57.890 [PublishDir-7] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- ProgrammingError: cursor \"_django_curs_139682122701696_sync_1\" already exists\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.DuplicateCursor: cursor \"_django_curs_139682122701696_sync_1\" already exists\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 91, in __iter__\\n    results = compiler.execute_sql(\\n              ^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 1574, in execute_sql\\n    cursor.execute(sql, params)\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 79, in execute\\n    return self._execute_with_wrappers(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 92, in _execute_with_wrappers\\n    return executor(sql, params, many, context)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 100, in _execute\\n    with self.db.wrap_database_errors:\\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.ProgrammingError: cursor \"_django_curs_139682122701696_sync_1\" already exists\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:57 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:29:58.066 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:58.066 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_Y/Sample_Y_raw_matrix.rds
    Jun-17 16:29:58.067 [PublishDir-4] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_Y/Sample_Y_raw_matrix.rds","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:58.095 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:58.095 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml
    Jun-17 16:29:58.096 [PublishDir-2] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:58.119 [PublishDir-10] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:29:57.981Z, updated_at:2025-06-17T14:29:57.981Z, uid:Se1mEWjGaeGlSG570000, key:scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_X/Sample_X_raw_matrix.h5ad, description:Output artifact for run 602, storage:32.0, suffix:.h5ad, kind:null, otype:AnnData, size:358322.0, hash:qPYyS3G5RCdcDjMeE53IXQ, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:58.119 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - Created output artifact Se1mEWjGaeGlSG570000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/Se1mEWjGaeGlSG570000)
    Jun-17 16:29:59.302 [TaskFinalizer-1] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:29:59.714 [PublishDir-8] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:29:59.715 [PublishDir-8] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/combined_raw_matrix.h5ad
    Jun-17 16:29:59.715 [PublishDir-8] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/combined_raw_matrix.h5ad","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:29:59.810 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T13:32:17.885Z, updated_at:2025-06-17T13:32:17.885Z, uid:vsxSvJTZWpaEXkAn0000, key:scratch/temp-scrnaseq/run_20250617_152628/alevin/mtx_conversions/versions.yml, description:Output artifact for run 602, storage:32.0, suffix:.yml, kind:null, otype:null, size:31.0, hash:hS5KWfErHHo+qHk5mBtQug, n_files:null, n_observations:null, _hash_type:md5, run:589.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:29:59.810 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Detected previous output artifact vsxSvJTZWpaEXkAn0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/vsxSvJTZWpaEXkAn0000)
    Jun-17 16:29:59.856 [PublishDir-3] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_Y/Sample_Y_raw_matrix.h5ad: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- ProgrammingError: cursor \"_django_curs_139682122701696_sync_2\" already exists\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.DuplicateCursor: cursor \"_django_curs_139682122701696_sync_2\" already exists\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 91, in __iter__\\n    results = compiler.execute_sql(\\n              ^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 1574, in execute_sql\\n    cursor.execute(sql, params)\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 79, in execute\\n    return self._execute_with_wrappers(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 92, in _execute_with_wrappers\\n    return executor(sql, params, many, context)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 100, in _execute\\n    with self.db.wrap_database_errors:\\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.ProgrammingError: cursor \"_django_curs_139682122701696_sync_2\" already exists\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:29:59 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:30:00.368 [PublishDir-9] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:00.368 [PublishDir-9] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/Sample_Y_alevin_results
    Jun-17 16:30:00.368 [PublishDir-9] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/Sample_Y_alevin_results","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:30:00.564 [PublishDir-4] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:00.384Z, updated_at:2025-06-17T14:30:00.384Z, uid:y65zr2jWRYcT53aw0000, key:scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/Sample_Y/Sample_Y_raw_matrix.rds, description:Output artifact for run 602, storage:32.0, suffix:.rds, kind:null, otype:null, size:292489.0, hash:CM+djYU3r714xPXLU91wlg, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:00.564 [PublishDir-4] DEBUG nextflow.lamin.LaminObserver - Created output artifact y65zr2jWRYcT53aw0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/y65zr2jWRYcT53aw0000)
    Jun-17 16:30:00.788 [PublishDir-2] ERROR nextflow.lamin.LaminObserver - Failed to create output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/versions.yml: Message:
    HTTP response code: 500
    HTTP response body: {"detail":"Failed to create artifact: {'message': 'Artifact creation failed -- ProgrammingError: cursor \"_django_curs_140505686190976_sync_3\" already exists\\n', 'stack_trace': 'Traceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\npsycopg2.errors.DuplicateCursor: cursor \"_django_curs_140505686190976_sync_3\" already exists\\n\\n\\nThe above exception was the direct cause of the following exception:\\n\\nTraceback (most recent call last):\\n  File \"/var/lang/lib/python3.12/site-packages/lamin_lambda_utils/artifact.py\", line 43, in _create\\n    artifact_dict = json.loads(serializers.serialize(\"json\", [artifact]))[0][\\n                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/__init__.py\", line 134, in serialize\\n    s.serialize(queryset, **options)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/base.py\", line 144, in serialize\\n    self.handle_m2m_field(obj, field)\\n  File \"/var/lang/lib/python3.12/site-packages/django/core/serializers/python.py\", line 93, in handle_m2m_field\\n    self._current[field.name] = [m2m_value(related) for related in m2m_iter]\\n                                                                   ^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 518, in _iterator\\n    yield from iterable\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/query.py\", line 91, in __iter__\\n    results = compiler.execute_sql(\\n              ^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/models/sql/compiler.py\", line 1574, in execute_sql\\n    cursor.execute(sql, params)\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 79, in execute\\n    return self._execute_with_wrappers(\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 92, in _execute_with_wrappers\\n    return executor(sql, params, many, context)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 100, in _execute\\n    with self.db.wrap_database_errors:\\n         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/utils.py\", line 91, in __exit__\\n    raise dj_exc_value.with_traceback(traceback) from exc_value\\n  File \"/var/lang/lib/python3.12/site-packages/django/db/backends/utils.py\", line 105, in _execute\\n    return self.cursor.execute(sql, params)\\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\\ndjango.db.utils.ProgrammingError: cursor \"_django_curs_140505686190976_sync_3\" already exists\\n\\n'}"}
    HTTP response headers: {content-type=[application/json], date=[Tue, 17 Jun 2025 14:30:00 GMT], server=[uvicorn], vary=[Accept-Encoding]}
    Jun-17 16:30:02.592 [PublishDir-8] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:02.471Z, updated_at:2025-06-17T14:30:02.471Z, uid:ryk9CeU228Ek1xNK0000, key:scratch/temp-scrnaseq/run_20250617_162908/alevin/mtx_conversions/combined_raw_matrix.h5ad, description:Output artifact for run 602, storage:32.0, suffix:.h5ad, kind:null, otype:AnnData, size:766272.0, hash:JvPGKTM4Vo8J9WDO5rQpDg, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:02.592 [PublishDir-8] DEBUG nextflow.lamin.LaminObserver - Created output artifact ryk9CeU228Ek1xNK0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/ryk9CeU228Ek1xNK0000)
    Jun-17 16:30:03.052 [PublishDir-9] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:02.930Z, updated_at:2025-06-17T14:30:02.930Z, uid:2OXQ8gxn3Q6G2vZI0000, key:scratch/temp-scrnaseq/run_20250617_162908/alevin/Sample_Y_alevin_results, description:Output artifact for run 602, storage:32.0, suffix:, kind:null, otype:null, size:1.4432476E7, hash:t_KsqLMee06qbVy6OI-g1A, n_files:19.0, n_observations:null, _hash_type:md5-d, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:true, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:03.052 [PublishDir-9] DEBUG nextflow.lamin.LaminObserver - Created output artifact 2OXQ8gxn3Q6G2vZI0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/2OXQ8gxn3Q6G2vZI0000)
    Jun-17 16:30:06.539 [TaskFinalizer-2] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:30:07.126 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:07.126 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevinqc/alevin_report_Sample_X.html
    Jun-17 16:30:07.127 [PublishDir-6] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevinqc/alevin_report_Sample_X.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:30:09.776 [PublishDir-6] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:09.654Z, updated_at:2025-06-17T14:30:09.654Z, uid:7OzFOOPvBL8umGMO0000, key:scratch/temp-scrnaseq/run_20250617_162908/alevinqc/alevin_report_Sample_X.html, description:Output artifact for run 602, storage:32.0, suffix:.html, kind:null, otype:null, size:1413633.0, hash:MUu8VoYUPUonKMYC20udTg, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:09.776 [PublishDir-6] DEBUG nextflow.lamin.LaminObserver - Created output artifact 7OzFOOPvBL8umGMO0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/7OzFOOPvBL8umGMO0000)
    Jun-17 16:30:12.748 [TaskFinalizer-3] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:30:13.303 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:13.303 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevinqc/alevin_report_Sample_Y.html
    Jun-17 16:30:13.303 [PublishDir-5] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/alevinqc/alevin_report_Sample_Y.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:30:15.441 [PublishDir-5] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:15.320Z, updated_at:2025-06-17T14:30:15.320Z, uid:k9bfuis6M0oSrS5d0000, key:scratch/temp-scrnaseq/run_20250617_162908/alevinqc/alevin_report_Sample_Y.html, description:Output artifact for run 602, storage:32.0, suffix:.html, kind:null, otype:null, size:1414073.0, hash:j0wbtZvtugfA4cZA1V680Q, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:15.441 [PublishDir-5] DEBUG nextflow.lamin.LaminObserver - Created output artifact k9bfuis6M0oSrS5d0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/k9bfuis6M0oSrS5d0000)
    Jun-17 16:30:22.107 [TaskFinalizer-4] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:30:23.811 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:23.812 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_report.html
    Jun-17 16:30:23.812 [PublishDir-7] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_report.html","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:30:24.366 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:24.367 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_data
    Jun-17 16:30:24.367 [PublishDir-10] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_data","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:30:25.973 [PublishDir-7] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:25.821Z, updated_at:2025-06-17T14:30:25.821Z, uid:SGunqu0KthQDDv7W0000, key:scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_report.html, description:Output artifact for run 602, storage:32.0, suffix:.html, kind:null, otype:null, size:4726292.0, hash:hL8rzoGxA7fZSP4hq/lkfQ, n_files:null, n_observations:null, _hash_type:md5, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:25.973 [PublishDir-7] DEBUG nextflow.lamin.LaminObserver - Created output artifact SGunqu0KthQDDv7W0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/SGunqu0KthQDDv7W0000)
    Jun-17 16:30:27.278 [PublishDir-10] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:27.160Z, updated_at:2025-06-17T14:30:27.160Z, uid:of6vFdZlwkoqHgJU0000, key:scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_data, description:Output artifact for run 602, storage:32.0, suffix:, kind:null, otype:null, size:560347.0, hash:fx-vTezNg3tDbWTwGyhhrw, n_files:15.0, n_observations:null, _hash_type:md5-d, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:true, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:27.278 [PublishDir-10] DEBUG nextflow.lamin.LaminObserver - Created output artifact of6vFdZlwkoqHgJU0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/of6vFdZlwkoqHgJU0000)
    Jun-17 16:30:28.046 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:28.046 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 602 at gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_plots
    Jun-17 16:30:28.047 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_plots","kwargs":{"run_id":602,"description":"Output artifact for run 602"}}
    Jun-17 16:30:30.292 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:30.159Z, updated_at:2025-06-17T14:30:30.159Z, uid:2BONuDwiZKMrFiGd0000, key:scratch/temp-scrnaseq/run_20250617_162908/multiqc/multiqc_plots, description:Output artifact for run 602, storage:32.0, suffix:, kind:null, otype:null, size:3843900.0, hash:6qHMpfGveEumJwRI4tKv2g, n_files:36.0, n_observations:null, _hash_type:md5-d, run:602.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:true, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:30.293 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Created output artifact 2BONuDwiZKMrFiGd0000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/2BONuDwiZKMrFiGd0000)
    DEBUG nextflow.lamin.LaminObserver - onFlowComplete triggered!
    DEBUG nextflow.lamin.instance.Instance - PATCH updateRecord: core.run, uid=ggdtzXYlvVqGjVpHfwcL, data=[finished_at:2025-06-17T16:30:30.293428150+02:00, _status_code:0]
    DEBUG nextflow.lamin.instance.Instance - Response from updateRecord: [id:602.0, uid:ggdtzXYlvVqGjVpHfwcL, _aux:null, name:exotic_swartz, space_id:1.0, _branch_code:1.0, report_id:null, _logfile_id:null, reference:null, transform_id:331.0, created_at:2025-06-17T14:29:15.019270+00:00, created_by_id:28.0, started_at:2025-06-17T14:29:11.834456+00:00, environment_id:null, finished_at:2025-06-17T14:30:30.293428+00:00, _status_code:0.0, reference_type:null, _is_consecutive:null, initiated_by_run_id:null]

</details>

### Example with Viash Hub workflow:

```bash
date > /tmp/lamin-test.txt

nextflow run https://packages.viash-hub.com/vsh/toolbox.git \
  -revision v0.1.1 \
  -main-script target/nextflow/bgzip/main.nf \
  -profile docker \
  -plugins nf-lamin@0.1.0 \
  -latest \
  --input /tmp/lamin-test.txt \
  --output output.gz \
  --publish_dir gs://di-temporary-public/scratch/temp-nf-lamin/run_$(date +%Y%m%d_%H%M%S)
```

    Nextflow 25.04.4 is available - Please consider updating your version to it
    N E X T F L O W  ~  version 24.10.5
    Pulling vsh/toolbox ...
    Launching `https://packages.viash-hub.com/vsh/toolbox` [loving_darwin] DSL2 - revision: 5cb3251eaf [v0.1.1]
    ✅ Connected to LaminDB instance 'laminlabs/lamindata' as 'rcannood'
    Transform W818bFm1ecyM0002 (https://staging.laminhub.com/laminlabs/lamindata/transform/W818bFm1ecyM0002)
    Run UkLH9Z5eAtcY6iL1bDBG (https://staging.laminhub.com/laminlabs/lamindata/transform/W818bFm1ecyM0002/UkLH9Z5eAtcY6iL1bDBG)
    [ae/dcc1b7] Submitted process > bgzip:processWf:bgzip_process (run)
    [e1/b4b48c] Submitted process > bgzip:publishFilesSimpleWf:publishFilesProc (run)
    [8d/0e0c41] Submitted process > bgzip:publishStatesSimpleWf:publishStatesProc (run)

> [!NOTE]
>
> Replace the `--publish_dir` with a valid path to a cloud bucket for
> this example to work.

<details>

<summary>

Detailed logs produced by `nf-lamin` in `.nextflow.log`

</summary>

    DEBUG nextflow.lamin.LaminObserver - onFlowCreate triggered!
    DEBUG nextflow.lamin.hub.LaminHub - Fetching access token...
    DEBUG nextflow.lamin.hub.LaminHub - Access token refreshed successfully.
    DEBUG nextflow.lamin.instance.Instance - GET /account
    DEBUG nextflow.lamin.instance.Instance - Response from getAccount: [id:b18149dc-7062-4f5e-8f2b-a82c7e13c5ed, lnid:QVOJJSTi, handle:rcannood, user_id:b18149dc-7062-4f5e-8f2b-a82c7e13c5ed, name:null, bio:null, website:null, github_handle:null, twitter_handle:null, linkedin_handle:null, avatar_url:b18149dc-7062-4f5e-8f2b-a82c7e13c5ed/avatar.png, created_at:2025-05-19T07:20:22.157833Z, updated_at:null]
    INFO  nextflow.lamin.LaminObserver - ✅ Connected to LaminDB instance 'laminlabs/lamindata' as 'rcannood'
    DEBUG nextflow.lamin.LaminObserver - Searching for existing Transform with key https://packages.viash-hub.com/vsh/toolbox:target/nextflow/bgzip/main.nf and revision v0.1.1
    DEBUG nextflow.lamin.instance.Instance - POST getRecords: core.transform, filter=[and:[[key:[eq:https://packages.viash-hub.com/vsh/toolbox:target/nextflow/bgzip/main.nf]], [version:[eq:v0.1.1]]]], limit=50, offset=0
    DEBUG nextflow.lamin.instance.Instance - Response from getRecords: [[type:pipeline, key:https://packages.viash-hub.com/vsh/toolbox:target/nextflow/bgzip/main.nf, source_code:{"repository":"https://packages.viash-hub.com/vsh/toolbox","main-script":"target/nextflow/bgzip/main.nf","commit-id":"5cb3251eaf4f716fbbf45669b21bb63f95448b6e","revision":"v0.1.1"}, version:v0.1.1, reference:https://packages.viash-hub.com/vsh/toolbox, created_at:2025-06-16T14:46:03.982506+00:00, description:bgzip: Block compression/decompression utility, hash:HYde-dNrm7hxGkcdzbwkeA, uid:W818bFm1ecyM0002, id:330.0, updated_at:2025-06-16T14:46:03.982506+00:00, reference_type:url, is_latest:true, _aux:null]]
    DEBUG nextflow.lamin.LaminObserver - Found 1 existing Transform(s) with key https://packages.viash-hub.com/vsh/toolbox:target/nextflow/bgzip/main.nf and revision v0.1.1
    INFO  nextflow.lamin.LaminObserver - Transform W818bFm1ecyM0002 (https://staging.laminhub.com/laminlabs/lamindata/transform/W818bFm1ecyM0002)
    DEBUG nextflow.lamin.instance.Instance - PUT createRecord: core.run, data=[transform_id:330.0, name:loving_darwin, created_at:2025-06-17T16:30:34.908139678+02:00, started_at:2025-06-17T16:30:34.908139678+02:00, _status_code:-1]
    DEBUG nextflow.lamin.instance.Instance - Response from createRecord: [[id:603.0, uid:UkLH9Z5eAtcY6iL1bDBG, _aux:null, name:loving_darwin, space_id:1.0, _branch_code:1.0, report_id:null, _logfile_id:null, reference:null, transform_id:330.0, created_at:2025-06-17T14:30:37.538033+00:00, created_by_id:28.0, started_at:2025-06-17T14:30:34.908140+00:00, environment_id:null, finished_at:null, _status_code:-1.0, reference_type:null, _is_consecutive:null, initiated_by_run_id:null]]
    INFO  nextflow.lamin.LaminObserver - Run UkLH9Z5eAtcY6iL1bDBG (https://staging.laminhub.com/laminlabs/lamindata/transform/W818bFm1ecyM0002/UkLH9Z5eAtcY6iL1bDBG)
    Jun-17 16:30:41.921 [TaskFinalizer-1] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:30:42.798 [TaskFinalizer-3] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:30:42.798 [TaskFinalizer-2] DEBUG nextflow.lamin.LaminObserver - onProcessComplete triggered!
    Jun-17 16:30:43.228 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:43.229 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 603 at gs://di-temporary-public/scratch/temp-nf-lamin/run_20250617_163032/output.gz
    Jun-17 16:30:43.230 [PublishDir-2] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-nf-lamin/run_20250617_163032/output.gz","kwargs":{"run_id":603,"description":"Output artifact for run 603"}}
    Jun-17 16:30:43.232 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - onFilePublish triggered!
    Jun-17 16:30:43.232 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Creating output artifact for run 603 at gs://di-temporary-public/scratch/temp-nf-lamin/run_20250617_163032/run.bgzip.state.yaml
    Jun-17 16:30:43.232 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - POST /instances/{instance_id}/artifacts/create: {"path":"gs://di-temporary-public/scratch/temp-nf-lamin/run_20250617_163032/run.bgzip.state.yaml","kwargs":{"run_id":603,"description":"Output artifact for run 603"}}
    Jun-17 16:30:45.489 [PublishDir-1] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-16T15:22:04.384Z, updated_at:2025-06-16T15:22:04.384Z, uid:jAxjm3Kj39aiPUW30000, key:scratch/temp-nf-lamin/run.bgzip.state.yaml, description:Output artifact for run 603, storage:32.0, suffix:.yaml, kind:null, otype:null, size:35.0, hash:p41ifSZvoMr4+4FoOJBpwA, n_files:null, n_observations:null, _hash_type:md5, run:563.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:45.490 [PublishDir-1] DEBUG nextflow.lamin.LaminObserver - Detected previous output artifact jAxjm3Kj39aiPUW30000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/jAxjm3Kj39aiPUW30000)
    Jun-17 16:30:46.281 [PublishDir-2] DEBUG nextflow.lamin.instance.Instance - Response from createArtifact: [statusCode:200.0, body:[message:Artifact created successfully, artifact:[version:null, is_latest:true, branch:1.0, space:1.0, _aux:null, created_at:2025-06-17T14:30:46.176Z, updated_at:2025-06-17T14:30:46.176Z, uid:j5gTGN8mGWKGwJz40000, key:scratch/temp-nf-lamin/run_20250617_163032/output.gz, description:Output artifact for run 603, storage:32.0, suffix:.gz, kind:null, otype:null, size:86.0, hash:Z8TJDV3943ECoVDiee8OJQ, n_files:null, n_observations:null, _hash_type:md5, run:603.0, schema:null, _key_is_virtual:false, created_by:28.0, _overwrite_versions:false, input_of_runs:[], _subsequent_runs:[], _actions:[]]]]
    Jun-17 16:30:46.282 [PublishDir-2] DEBUG nextflow.lamin.LaminObserver - Created output artifact j5gTGN8mGWKGwJz40000 (https://staging.laminhub.com/laminlabs/lamindata/artifact/j5gTGN8mGWKGwJz40000)
    DEBUG nextflow.lamin.LaminObserver - onFlowComplete triggered!
    DEBUG nextflow.lamin.instance.Instance - PATCH updateRecord: core.run, uid=UkLH9Z5eAtcY6iL1bDBG, data=[finished_at:2025-06-17T16:30:46.282525416+02:00, _status_code:0]
    DEBUG nextflow.lamin.instance.Instance - Response from updateRecord: [id:603.0, uid:UkLH9Z5eAtcY6iL1bDBG, _aux:null, name:loving_darwin, space_id:1.0, _branch_code:1.0, report_id:null, _logfile_id:null, reference:null, transform_id:330.0, created_at:2025-06-17T14:30:37.538033+00:00, created_by_id:28.0, started_at:2025-06-17T14:30:34.908140+00:00, environment_id:null, finished_at:2025-06-17T14:30:46.282525+00:00, _status_code:0.0, reference_type:null, _is_consecutive:null, initiated_by_run_id:null]

</details>

## Settings

The plugin supports the following settings in the `nextflow.config`
file:

```groovy
lamin {
  // The LaminDB instance to use
  instance = "laminlabs/lamindata"
  // The API key for the LaminDB instance
  api_key = secrets.LAMIN_API_KEY
  // The project name in LaminDB
  project = "your-lamin-project"
  // The environment name in LaminDB
  env = "prod"
  // The Supabase API URL for the LaminDB instance (if env is set to null)
  supabase_api_url = "https://your-supabase-api-url.supabase.co"
  // The Supabase anon key for the LaminDB instance (if env is set to null)
  supabase_anon_key = secrets.SUPABASE_ANON_KEY
  // The number of retries for API requests
  max_retries = 3
  // The delay between retries in milliseconds
  retry_delay = 100
}
```

In addition to the above settings, you can also set the following
environment variables:

```bash
export LAMIN_CURRENT_INSTANCE="laminlabs/lamindata"
export LAMIN_API_KEY="your-lamin-api-key"
export LAMIN_CURRENT_PROJECT="your-lamin-project"
export LAMIN_ENV="prod"
export SUPABASE_API_URL="https://your-supabase-api-url.supabase.co"
export SUPABASE_ANON_KEY="your-supabase-anon-key"
export LAMIN_MAX_RETRIES=3
export LAMIN_RETRY_DELAY=100
```

## Contributing

See [CONTRIBUTING.md](CONTRIBUTING.md) for more information about
contributing to this repository.
